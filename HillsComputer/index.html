<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>電腦入侵中……</title>
<style>
html,body{
  margin:0;
  height:100%;
  overflow:hidden;
  background:url('/monitor0314/images/XP.jpg') no-repeat center/cover;
  font-family:system-ui;
}
.desktop{
  height:100%;
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:16px;
  align-items:flex-start;
}
.icon{
  width:80px;
  display:flex;
  flex-direction:column;
  align-items:center;
  cursor:pointer;
  color:white;
  font-size:14px;
  text-align:center;
  text-shadow:0 2px 4px black;
  user-select:none;
}
.icon img{
  width:48px;
  height:48px;
  margin-bottom:6px;
}
.window{
  display:none;
  position:fixed;
  background:#1e1e1e;
  border:1px solid #000;
  border-radius:8px;
  box-shadow:2px 2px 12px rgba(0,0,0,0.5);
  overflow:hidden;
}
.titlebar{
  background:#0a64ad;
  color:white;
  padding:4px 8px;
  cursor:move;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.content{
  padding:10px;
  display:flex;
  flex-wrap:wrap;
  gap:12px;
}
.folder-icon{
  width:80px;
  text-align:center;
  cursor:pointer;
  color:white;
}
.folder-icon img{
  width:48px;
  height:48px;
  margin-bottom:4px;
}
.video-content video{
  width:100%;
  height:100%;
  border-radius:4px;
}
.pwd-box{
  width:48px;
  height:48px;
  font-size:24px;
  text-align:center;
}
</style>
</head>
<body>

<div class="desktop">
  <div class="icon" data-type="image" data-src="/monitor0314/images/PC.png">
    <img src="/monitor0314/icons/Desktop.png">我的電腦
  </div>

  <div class="icon" id="trash">
    <img src="/monitor0314/icons/Trash.png">資源回收桶
  </div>

  <div class="icon" data-type="gallery"
    data-images='[
      "/monitor0314/images/Calendar01.jpg",
      "/monitor0314/images/Calendar02.jpg",
      "/monitor0314/images/Calendar03.jpg",
      "/monitor0314/images/Calendar04.jpg",
      "/monitor0314/images/Calendar05.jpg",
      "/monitor0314/images/Calendar06.jpg",
      "/monitor0314/images/Calendar07.jpg",
      "/monitor0314/images/Calendar08.jpg",
      "/monitor0314/images/Calendar09.jpg",
      "/monitor0314/images/Calendar10.jpg",
      "/monitor0314/images/Calendar11.jpg",
      "/monitor0314/images/Calendar12.jpg"
    ]'>
    <img src="/monitor0314/icons/Calendar.png">日曆
  </div>

  <div class="icon" data-type="text" data-src="此為無關檔案。">
    <img src="/monitor0314/icons/File.png">資料夾
  </div>

  <div class="icon" data-type="url" data-src="https://www.google.com/">
    <img src="/monitor0314/icons/google.png">GOOGOO
  </div>

  <div class="icon"
       id="accountBook"
       draggable="true"
       data-type="pdf"
       data-password="0519"
       data-src="/monitor0314/another/ledger.pdf">
    <img src="/monitor0314/icons/Notepad.png">帳本
  </div>

  <div class="icon" data-type="image" data-src="/monitor0314/images/family.jpg">
    <img src="/monitor0314/icons/photo.png">瑪莉亞與喬登
  </div>

  <div class="icon" data-type="folder" id="monitorIcon">
    <img src="/monitor0314/icons/monitor.png">監視器
  </div>
</div>

<!-- ===== Monitor Folder Window ===== -->
<div class="window" id="monitorWindow" style="width:500px;height:350px;left:100px;top:100px;">
  <div class="titlebar" id="monitorTitle">
    <span>監視器</span>
    <button id="monitorClose">X</button>
  </div>
  <div class="content" id="monitorContent"></div>
</div>

<!-- ===== Video Window ===== -->
<div class="window" id="videoWindow" style="width:600px;height:400px;left:200px;top:120px;">
  <div class="titlebar" id="videoTitle">
    <span>監視器畫面</span>
    <button id="videoClose">X</button>
  </div>
  <div class="content video-content" id="videoContent"></div>
</div>

<script>
/* ===== 全部圖片預加載 ===== */
document.querySelectorAll('.icon img').forEach(img=>{
  const pre=new Image(); pre.src=img.src;
});
document.querySelectorAll('.icon[data-type="gallery"]').forEach(icon=>{
  JSON.parse(icon.dataset.images).forEach(src=>{
    const pre=new Image(); pre.src=src;
});

/* ===== 一般 icon 點擊事件 ===== */
document.querySelectorAll('.icon').forEach(icon=>{
  icon.addEventListener('click',()=>{
    const type=icon.dataset.type;
    if(!type || type==='folder') return;

    const src=icon.dataset.src;
    const pwd=icon.dataset.password;

    if(type==='url'){window.open(src,'_blank');return;}
    if(type==='text'){alert(src);return;}
    if(type==='image'){alert('顯示圖片: '+src);return;}
    if(type==='gallery'){let imgs=JSON.parse(icon.dataset.images),i=0;const render=()=>{
      const img=new Image(); img.src=imgs[i]; alert('顯示圖片: '+imgs[i]); i=(i+1)%imgs.length;};render();return;}
    if(type==='pdf'){alert('PDF密碼:'+pwd);return;}
  });
});

/* ===== Monitor Folder Window ===== */
const monitorIcon = document.getElementById('monitorIcon');
const monitorWindow = document.getElementById('monitorWindow');
const monitorContent = document.getElementById('monitorContent');
const monitorClose = document.getElementById('monitorClose');
const videoWindow = document.getElementById('videoWindow');
const videoContent = document.getElementById('videoContent');
const videoClose = document.getElementById('videoClose');

const videos=[
  '/monitor0314/videos/video1.mp4',
  '/monitor0314/videos/video2.mp4',
  '/monitor0314/videos/video3.mp4',
  '/monitor0314/videos/video4.mp4'
];

monitorIcon.onclick=()=>{
  monitorContent.innerHTML=videos.map((v,i)=>`
    <div class="folder-icon" data-video="${v}">
      <img src="/monitor0314/icons/monitor.png">
      <div>監視器 ${i+1}</div>
    </div>`).join('');
  monitorWindow.style.display='block';

  monitorContent.querySelectorAll('.folder-icon').forEach(icon=>{
    icon.onclick=()=>{
      videoContent.innerHTML=`<video src="${icon.dataset.video}" controls autoplay></video>`;
      videoWindow.style.display='block';
    };
  });
};

monitorClose.onclick=()=>{monitorWindow.style.display='none';};

/* ===== Video Window Close ===== */
videoClose.onclick=()=>{
  videoWindow.style.display='none';
  videoContent.innerHTML='';
};

/* ===== 拖曳功能 ===== */
function makeDraggable(win,title){
  let d=false,x=0,y=0;
  title.onmousedown=e=>{d=true;x=e.clientX-win.offsetLeft;y=e.clientY-win.offsetTop;};
  document.onmousemove=e=>{if(d){win.style.left=e.clientX-x+'px';win.style.top=e.clientY-y+'px';}};
  document.onmouseup=()=>d=false;
}
makeDraggable(monitorWindow,document.getElementById('monitorTitle'));
makeDraggable(videoWindow,document.getElementById('videoTitle'));

/* ===== 資源回收桶拖曳帳本 ===== */
const book=document.getElementById('accountBook');
const trash=document.getElementById('trash');
book.addEventListener('dragstart',e=>e.dataTransfer.setData('x','book'));
trash.addEventListener('dragover',e=>e.preventDefault());
trash.addEventListener('drop',e=>{
  if(e.dataTransfer.getData('x')==='book') book.remove();
});
</script>

</body>
</html>
